<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>‚≠ê Magical Coin of Fate - Digital Fortune Teller | Interactive Coin Flip</title>
    <meta name="title" content="‚≠ê Magical Coin of Fate - Digital Fortune Teller | Interactive Coin Flip">
    <meta name="description" content="‚ú® Dare to flip the magical coin? Experience stunning fortune-telling with our enchanted digital coin flip tool. Beautiful animations, mystical sounds, and powerful predictions await. Perfect for any decision!">
    <meta name="keywords" content="coin flip, magical coin toss, fortune teller, decision maker, coin game, magical fortune, digital coin, fortune teller, interactive game, decision tool">
    <meta name="author" content="Magical Coin of Fate">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="language" content="English">
    <meta name="revisit-after" content="3 days">

    <!-- Canonical URL - Fixed Netlify duplicate content -->
    <link rel="canonical" href="https://coinoffate.live/">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/public/favicon.svg">
    <link rel="icon" type="image/png" sizes="192x192" href="/public/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/public/icon-512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/public/apple-touch-icon.png">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://coinoffate.live/">
    <meta property="og:title" content="‚≠ê Magical Coin of Fate - Digital Fortune Teller">
    <meta property="og:description" content="‚ú® Dare to flip the magical coin? Experience stunning fortune-telling with enchanted animations, mystical sounds, and powerful predictions!">
    <meta property="og:image" content="https://coinoffate.live/public/icon-512.png">
    <meta property="og:image:width" content="512">
    <meta property="og:image:height" content="512">
    <meta property="og:image:alt" content="Magical Coin - Digital Fortune Teller">
    <meta property="og:site_name" content="Magical Coin of Fate">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://coinoffate.live/">
    <meta name="twitter:title" content="‚≠ê Magical Coin of Fate - Digital Fortune Teller">
    <meta name="twitter:description" content="‚ú® Dare to flip the magical coin? Enchanted animations, mystical sounds, and powerful predictions await!">
    <meta name="twitter:image" content="https://coinoffate.live/public/icon-512.png">
    <meta name="twitter:image:alt" content="Magical Coin Fortune Teller">

    <!-- Theme Color - Electric Blue -->
    <meta name="theme-color" content="#2563eb">
    <meta name="msapplication-TileColor" content="#1e3a8a">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/public/manifest.json">

    <!-- Humans.txt -->
    <link rel="author" href="/public/humans.txt">

    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.tailwindcss.com">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Magical Coin of Fate - Digital Fortune Teller",
      "alternateName": "Interactive Coin Flip",
      "url": "https://coinoffate.live/",
      "description": "Dare to flip the magical coin? Experience stunning fortune-telling with our enchanted digital coin flip tool. Beautiful animations, mystical sounds, and powerful predictions for all your decisions.",
      "applicationCategory": "EntertainmentApplication",
      "operatingSystem": "Any",
      "browserRequirements": "Requires JavaScript. Requires HTML5.",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "Magical Coin of Fate",
        "url": "https://coinoffate.live/"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "ratingCount": "256",
        "reviewCount": "89"
      },
      "keywords": "coin flip, magical coin toss, fortune teller, decision maker, coin game, magical fortune, digital coin, interactive game"
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Magical Coin of Fate",
      "url": "https://coinoffate.live/",
      "logo": "https://coinoffate.live/public/icon-512.png",
      "sameAs": [
        "https://coinoffate.live/"
      ],
      "description": "Interactive fortune-telling and decision-making tool with stunning animations and mystical predictions"
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Magical Coin of Fate",
      "url": "https://coinoffate.live/",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://coinoffate.live/?s={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the Magical Coin of Fate?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The Magical Coin of Fate is an interactive digital coin flip tool that helps you make decisions with stunning visual effects. It features beautiful animations, mystical sound effects, and enchanting fortune-telling quotes."
          }
        },
        {
          "@type": "Question",
          "name": "Is this a real fortune teller?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "This is a fun entertainment tool using advanced probability algorithms. The coin flips are generated using Markov chain probability for entertainment purposes only, with a beautiful visual experience."
          }
        }
      ]
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: #0a0a0a;
            color: #fff;
            overflow-x: hidden;
        }

        @keyframes magicalFloat {
            0% { transform: translateX(0px) translateY(0px) rotate(0deg); }
            25% { transform: translateX(-25px) translateY(-15px) rotate(-3deg); }
            50% { transform: translateX(0px) translateY(-30px) rotate(0deg); }
            75% { transform: translateX(25px) translateY(-15px) rotate(3deg); }
            100% { transform: translateX(0px) translateY(0px) rotate(0deg); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes patrioticGlow {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 40px rgba(37, 99, 235, 0.7), 0 0 80px rgba(177, 26, 33, 0.5);
            }
            50% {
                opacity: 0.85;
                box-shadow: 0 0 60px rgba(37, 99, 235, 0.9), 0 0 100px rgba(177, 26, 33, 0.7);
            }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(0.95); }
            75% { opacity: 0.85; transform: scale(0.98); }
        }

        @keyframes starFloat {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            25% { transform: translateX(-20px) translateY(10px) rotate(-8deg); }
            50% { transform: translateX(-35px) translateY(-5px) rotate(4deg); }
            75% { transform: translateX(-20px) translateY(12px) rotate(-4deg); }
            100% { transform: translateX(0) translateY(0) rotate(0deg); }
        }

        @keyframes particleFloat {
            0% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
            50% { transform: translateY(-15px) rotate(2deg); opacity: 1; }
            100% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
        }

        @keyframes shimmer {
            0% { transform: translateX(0%) scaleY(1); }
            50% { transform: translateX(-8%) scaleY(1.05); }
            100% { transform: translateX(0%) scaleY(1); }
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }

        .magical-flow {
            animation: magicalFloat 18s ease-in-out infinite;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        .animate-pulse {
            animation: patrioticGlow 2.5s infinite;
        }

        .twinkle {
            animation: twinkle 3s infinite;
        }

        .coin-container {
            box-shadow:
                0 0 60px rgba(37, 99, 235, 0.6),
                0 0 100px rgba(177, 26, 33, 0.4),
                inset 0 0 80px rgba(37, 99, 235, 0.15);
            background: radial-gradient(circle at center,
                rgba(37, 99, 235, 0.25),
                rgba(30, 58, 138, 0.15),
                rgba(0, 0, 0, 0.9));
        }

        .bg-gradient-text {
            background: linear-gradient(135deg, #b11a21, #2563eb, #60a5fa, #e0474c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: gradient-shift 4s ease infinite;
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .star {
            animation: starFloat 5s ease-in-out infinite;
        }

        .particle {
            animation: particleFloat 6s ease-in-out infinite;
        }

        .shimmer {
            animation: shimmer 12s ease-in-out infinite;
        }

        /* Patriotic glow effect - Red, White, Blue */
        .patriotic-glow {
            filter: drop-shadow(0 0 8px rgba(37, 99, 235, 0.7))
                    drop-shadow(0 0 12px rgba(177, 26, 33, 0.5));
        }

        /* Magical text shadow - Red, Blue, White highlights */
        .magical-text {
            text-shadow:
                0 0 10px rgba(37, 99, 235, 0.9),
                0 0 20px rgba(177, 26, 33, 0.7),
                0 0 30px rgba(96, 165, 250, 0.5),
                0 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Hover micro-interactions */
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
        }

        /* Pulse ring animation */
        .pulse-ring {
            animation: pulse-ring 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Loading Screen -->
        <div id="loading" class="min-h-screen bg-black text-blue-500 font-mono relative overflow-hidden">
            <div class="absolute inset-0">
                <div id="particle-layer" class="shimmer"></div>
                <div id="floating-particles"></div>
            </div>
            <div class="relative z-10 flex items-center justify-center min-h-screen">
                <div class="text-center px-4">
                    <div class="text-6xl mb-6 patriotic-glow">‚ú®</div>
                    <div class="text-4xl mb-4 twinkle font-light tracking-wider magical-text" style="font-family: Georgia, serif;">
                        Magical Coin of Fate
                    </div>
                    <div class="text-lg text-blue-400 italic mb-2">
                        "Believe... the magic is real"
                    </div>
                    <div class="text-sm text-gray-500 mb-8">
                        Dare you flip the magical coin?
                    </div>
                    <div class="mt-8">
                        <button onclick="startApp()" class="px-8 py-3 border-2 border-blue-500 text-blue-500 hover:bg-blue-500 hover:text-white transition-all duration-300 font-light tracking-wider patriotic-glow hover-lift">
                            ENTER THE MAGIC
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="main-app" class="min-h-screen bg-black text-white relative overflow-hidden" style="display: none;">
            <!-- Background - Red, White, Blue Theme -->
            <div class="absolute inset-0">
                <div class="absolute inset-0 bg-gradient-to-br from-blue-900/25 via-black to-red-900/20"></div>
                <div class="absolute inset-0 opacity-40 magical-flow" style="
                    background-image:
                        radial-gradient(circle at 30% 70%, rgba(37,99,235,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 70% 30%, rgba(177,26,33,0.08) 0%, transparent 50%),
                        radial-gradient(circle at 50% 50%, rgba(96,165,250,0.06) 0%, transparent 40%),
                        repeating-linear-gradient(45deg, transparent, transparent 100px, rgba(37,99,235,0.02) 102px),
                        repeating-linear-gradient(-45deg, transparent, transparent 100px, rgba(177,26,33,0.02) 102px);
                    background-size: 450px 450px, 350px 350px, 500px 500px, 200px 200px, 200px 200px;
                "></div>

                <!-- Floating Magical elements -->
                <div class="absolute inset-0" id="floating-elements"></div>

                <!-- Ambient light layer -->
                <div class="absolute bottom-0 left-0 right-0 h-64 bg-gradient-to-t from-blue-900/20 to-transparent shimmer"></div>
            </div>

            <!-- Header -->
            <div class="relative text-center py-16 px-4 border-b border-blue-800/30">
                <div class="flex items-center justify-center gap-4 mb-8">
                    <div class="w-12 h-12 text-blue-500 flex items-center justify-center text-4xl star">‚≠ê</div>
                    <div class="text-center">
                        <h1 class="text-6xl font-bold tracking-widest bg-gradient-text mb-2 magical-text" style="font-family: Georgia, serif;">
                            MAGICAL COIN
                        </h1>
                        <div class="text-lg text-blue-400 italic font-light tracking-wider twinkle" style="font-family: Georgia, serif;">
                            "Your destiny awaits..."
                        </div>
                        <div class="text-sm text-gray-500 mt-2">
                            Let fate reveal the answer
                        </div>
                    </div>
                    <div class="w-12 h-12 text-red-500 flex items-center justify-center text-4xl star" style="animation-delay: 2s;">‚ú®</div>
                </div>

                <div id="premium-badge" class="inline-flex items-center gap-2 px-4 py-2 border border-blue-500/50 rounded bg-blue-900/20 patriotic-glow" style="display: none;">
                    <span>‚≠ê</span>
                    <span class="text-sm tracking-wide text-blue-400 font-light">MAGICAL PREMIUM</span>
                </div>
            </div>

            <!-- Quote Section -->
            <div id="quote-section" class="relative py-12 px-6 border-b border-blue-800/20">
                <div class="max-w-2xl mx-auto text-center">
                    <div class="text-4xl mb-4 twinkle">‚ú®</div>
                    <p id="current-quote" class="text-xl text-blue-300 italic leading-relaxed font-light twinkle" style="font-family: Georgia, serif;">
                        "The magic whispers your fortune..."
                    </p>
                    <p id="quote-translation" class="text-sm text-gray-500 mt-3 tracking-wider font-light">
                        What destiny awaits in the stars?
                    </p>
                </div>
            </div>

            <!-- Main Coin Section -->
            <div class="relative max-w-lg mx-auto px-6 py-16">
                <!-- Coin -->
                <div class="flex justify-center mb-16">
                    <div class="relative">
                        <div id="coin" class="w-64 h-64 rounded-full border-4 border-blue-500 shadow-2xl flex items-center justify-center transform transition-all duration-2500 hover:scale-105 coin-container animate-pulse hover-lift">
                            <div id="coin-content" class="text-center">
                                <div class="text-8xl mb-4 patriotic-glow">‚ú®</div>
                                <div class="text-lg text-blue-300 tracking-wider font-light magical-text">READY FOR MAGIC</div>
                            </div>
                        </div>

                        <!-- Magical glow rings - Red, White, Blue -->
                        <div class="absolute inset-0 rounded-full border border-blue-500/50 scale-110 pulse-ring"></div>
                        <div class="absolute inset-0 rounded-full border border-red-500/30 scale-125 pulse-ring" style="animation-delay: 0.7s;"></div>
                        <div class="absolute inset-0 rounded-full border border-blue-400/20 scale-140 pulse-ring" style="animation-delay: 1.4s;"></div>

                        <!-- Floating particles around coin -->
                        <div class="absolute -left-12 top-1/4 text-3xl particle" style="animation-delay: 0.5s;">‚≠ê</div>
                        <div class="absolute -right-12 top-1/3 text-3xl particle" style="animation-delay: 1.5s;">üí´</div>
                        <div class="absolute -left-8 bottom-1/4 text-2xl star" style="animation-delay: 2.5s;">‚ú®</div>
                        <div class="absolute -right-8 bottom-1/3 text-2xl star" style="animation-delay: 3.5s;">üåü</div>
                    </div>
                </div>

                <!-- Flip Button -->
                <div class="text-center mb-12">
                    <button id="flip-btn" onclick="flipCoin()" class="px-16 py-5 border-2 border-blue-500 hover:bg-gradient-to-r hover:from-blue-500 hover:to-red-500 hover:text-white hover:border-transparent transition-all duration-300 font-bold tracking-widest text-xl transform hover:scale-105 patriotic-glow magical-text hover-lift" style="font-family: Georgia, serif;">
                        ‚ú® DISCOVER FATE ‚ú®
                    </button>
                </div>

                <!-- Stats -->
                <div class="grid grid-cols-3 gap-6 mb-12">
                    <div class="text-center p-6 border border-blue-800/30 bg-blue-900/10 rounded patriotic-glow hover-lift">
                        <div class="text-3xl mb-2 twinkle">‚ú®</div>
                        <div id="total-count" class="text-4xl font-bold text-blue-400 mb-2 magical-text" style="font-family: Georgia, serif;">0</div>
                        <div class="text-xs text-gray-500 tracking-wider font-light">FLIPS</div>
                    </div>
                    <div class="text-center p-6 border border-blue-800/30 bg-blue-900/10 rounded patriotic-glow hover-lift">
                        <div class="text-3xl mb-2 twinkle">‚≠ê</div>
                        <div id="heads-count" class="text-4xl font-bold text-blue-400 mb-2 magical-text" style="font-family: Georgia, serif;">0</div>
                        <div class="text-xs text-gray-500 tracking-wider font-light">HEADS</div>
                    </div>
                    <div class="text-center p-6 border border-red-800/30 bg-red-900/10 rounded patriotic-glow hover-lift">
                        <div class="text-3xl mb-2 twinkle">üî¥</div>
                        <div id="tails-count" class="text-4xl font-bold text-red-400 mb-2 magical-text" style="font-family: Georgia, serif;">0</div>
                        <div class="text-xs text-gray-500 tracking-wider font-light">TAILS</div>
                    </div>
                </div>

                <!-- History -->
                <div id="history-section" class="mb-12" style="display: none;">
                    <h3 class="text-center text-lg font-light mb-6 tracking-wider text-blue-400 twinkle" style="font-family: Georgia, serif;">
                        ‚ú® Magical Chronicle ‚ú®
                    </h3>
                    <div class="flex justify-center">
                        <div id="history-display" class="flex gap-3"></div>
                    </div>
                </div>

                <!-- Free Limit Warning -->
                <div id="limit-warning" class="mb-8 p-4 border-2 border-blue-600/60 bg-blue-900/30 text-center rounded patriotic-glow" style="display: none;">
                    <div class="text-3xl mb-2">‚ö†Ô∏è</div>
                    <p class="text-blue-300 text-sm font-light">
                        The magic is fading... <span id="remaining-flips">2</span> flips remaining!
                    </p>
                </div>

                <!-- Reset Button -->
                <div class="text-center">
                    <button onclick="resetApp()" class="px-10 py-3 border border-gray-700 hover:border-blue-500 text-gray-500 hover:text-blue-400 transition-all duration-300 font-light tracking-wider hover-lift" style="font-family: Georgia, serif;">
                        ‚ú® RESET MAGIC ‚ú®
                    </button>
                </div>
            </div>

            <!-- Subscription Modal -->
            <div id="subscription-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center p-4" style="display: none;">
                <div class="bg-gradient-to-br from-blue-900/30 via-black to-red-900/20 border-2 border-blue-500 p-8 max-w-md w-full text-center relative rounded patriotic-glow">
                    <div class="absolute inset-0 bg-blue-500/5 rounded"></div>
                    <div class="relative z-10">
                        <div class="mb-6">
                            <div class="text-6xl mx-auto mb-6 twinkle">‚ú®</div>
                            <h2 class="text-3xl font-bold mb-4 tracking-wider text-blue-400 magical-text" style="font-family: Georgia, serif;">
                                Unleash Infinite Magic
                            </h2>
                            <p class="text-gray-300 leading-relaxed font-light">
                                Unlimited power awaits for endless mystical flips...
                            </p>
                        </div>

                        <div class="border-2 border-blue-800/50 p-6 mb-8 bg-blue-900/20 rounded patriotic-glow">
                            <div class="text-4xl font-bold text-blue-400 mb-4 magical-text" style="font-family: Georgia, serif;">$2.99/month</div>
                            <div class="space-y-3 text-sm text-gray-300 font-light">
                                <div class="flex items-center justify-center gap-3">
                                    <span>‚ôæÔ∏è</span>
                                    <span>Unlimited magical flips</span>
                                </div>
                                <div class="flex items-center justify-center gap-3">
                                    <span>‚≠ê</span>
                                    <span>Magical Premium badge</span>
                                </div>
                                <div class="flex items-center justify-center gap-3">
                                    <span>üîÆ</span>
                                    <span>Exclusive mystical sound effects</span>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <button onclick="buyPremium()" class="w-full py-3 bg-gradient-to-r from-blue-500 to-red-500 text-white hover:from-blue-600 hover:to-red-600 transition-all duration-300 font-bold tracking-wider patriotic-glow hover-lift" style="font-family: Georgia, serif;">
                                ‚ú® UNLOCK UNLIMITED MAGIC ‚ú®
                            </button>
                            <button onclick="closeModal()" class="w-full py-3 border border-gray-600 hover:border-blue-500 text-gray-400 hover:text-blue-400 transition-all duration-300 font-light tracking-wider hover-lift" style="font-family: Georgia, serif;">
                                MAYBE LATER
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="relative border-t border-blue-800/30 py-8 text-center">
                <div class="space-y-3 text-xs text-gray-600 font-light">
                    <div class="flex justify-center gap-4 text-2xl mb-4">
                        <span class="star">‚≠ê</span>
                        <span class="particle" style="animation-delay: 0.5s;">‚ú®</span>
                        <span class="star" style="animation-delay: 1s;">üí´</span>
                        <span class="particle" style="animation-delay: 1.5s;">üåü</span>
                        <span class="star" style="animation-delay: 2s;">‚≠ê</span>
                    </div>
                    <p class="text-blue-500/70">Powered by Magical Markov Chain Probability</p>
                    <p style="font-family: Georgia, serif;" class="italic">"In the stars above, your destiny shines..."</p>
                    <p class="text-xs">Made with mystical magic ‚ú®</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let tosses = 0;
        let history = [];
        let isPremium = false;
        let markovState = 'H';
        let isFlipping = false;

        const markovMatrix = {
            'H': { 'H': 0.45, 'T': 0.55 },
            'T': { 'H': 0.55, 'T': 0.45 }
        };

        // Magical quotes
        const magicalQuotes = [
            "The magic has spoken... believe in wonder|Your fate sparkles in the cosmos",
            "Embrace the wonder... miracles await|Magic reveals eternal truths",
            "The veil of magic grows strong|What destiny brings beckons you",
            "Ancient magic guides your path|The mystical realm calls",
            "In starlight, truth is revealed|Your fortune awaits in wonder",
            "The magical coin knows your fate|Cosmic powers at work",
            "Stars dance in the moonlight|Your destiny is written in light",
            "The magical realm has chosen|Mystical energies surround you",
            "Embrace what the magic brings|Fortune favors the bold souls",
            "The cosmic voices sing out|Your path is illuminated by starlight",
            "Destiny awaits your choice|The universe decides your fortune",
            "Eternal magic guides the coin|Celestial forces align"
        ];

        // Sound effects (using Web Audio API for festive sounds)
        let audioContext;
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playMagicalChime() {
            initAudio();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.5);

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function playJingleSound() {
            initAudio();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(1000, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1500, audioContext.currentTime + 0.3);

            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        // Floating particles effect (falling stars and sparkles)
        function createFloatingParticles() {
            const container = document.getElementById('floating-particles');
            const particleChars = ['‚≠ê', '‚ú®', 'üí´', 'üåü', '‚ú¶'];
            const columns = Math.floor(window.innerWidth / 50);

            for (let i = 0; i < columns; i++) {
                const drop = document.createElement('div');
                drop.style.position = 'absolute';
                drop.style.left = i * 50 + 'px';
                drop.style.top = Math.random() * -1000 + 'px';
                drop.style.fontSize = '20px';
                drop.style.opacity = '0.4';
                drop.style.animation = `fall ${5 + Math.random() * 8}s linear infinite`;
                drop.style.animationDelay = Math.random() * 5 + 's';

                drop.textContent = particleChars[Math.floor(Math.random() * particleChars.length)];
                container.appendChild(drop);
            }
        }

        // Create floating magical elements
        function createFloatingElements() {
            const container = document.getElementById('floating-elements');
            const elements = ['‚≠ê', '‚ú®', 'üí´', 'üåü', '‚ú¶', 'üí†'];

            for (let i = 0; i < 25; i++) {
                const element = document.createElement('div');
                element.className = 'absolute opacity-20 text-2xl';
                element.style.left = Math.random() * 100 + '%';
                element.style.top = Math.random() * 100 + '%';

                // Alternate between star and particle animations
                if (i % 2 === 0) {
                    element.className += ' star';
                } else {
                    element.className += ' particle';
                }

                element.style.animationDelay = Math.random() * 5 + 's';
                element.style.animationDuration = (4 + Math.random() * 4) + 's';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                container.appendChild(element);
            }
        }

        // Create spooky particle burst effect
        function createParticleBurst(x, y) {
            const particles = ['‚ú®', '‚≠ê', 'üí´', 'üåü'];
            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'absolute text-2xl';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.pointerEvents = 'none';
                particle.textContent = particles[Math.floor(Math.random() * particles.length)];

                const angle = (i / 12) * Math.PI * 2;
                const velocity = 100 + Math.random() * 100;
                const tx = Math.cos(angle) * velocity;
                const ty = Math.sin(angle) * velocity;

                particle.animate([
                    { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                    { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
                ], {
                    duration: 1000,
                    easing: 'cubic-bezier(0, .9, .57, 1)'
                });

                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 1000);
            }
        }

        // Start app
        function startApp() {
            playJingleSound();
            document.getElementById('loading').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
            createFloatingElements();
            updateQuote();
        }

        // Update quote - Christmas version
        function updateQuote() {
            const quote = magicalQuotes[Math.floor(Math.random() * magicalQuotes.length)];
            const parts = quote.split('|');
            document.getElementById('current-quote').textContent = `"${parts[0]}"`;
            document.getElementById('quote-translation').textContent = parts[1];
        }

        // Markov prediction
        function getMarkovPrediction() {
            const probabilities = markovMatrix[markovState];
            const random = Math.random();
            return random < probabilities['H'] ? 'H' : 'T';
        }

        // Flip coin - Christmas version with sound effects
        function flipCoin() {
            if (!isPremium && tosses >= 10) {
                playMagicalChime();
                document.getElementById('subscription-modal').style.display = 'flex';
                return;
            }

            if (isFlipping) return;

            isFlipping = true;
            playJingleSound();

            const coin = document.getElementById('coin');
            const coinContent = document.getElementById('coin-content');
            const flipBtn = document.getElementById('flip-btn');

            coin.classList.add('animate-spin');
            coin.style.transform = 'scale(1.2)';
            flipBtn.textContent = '‚ú® MAGIC IN PROGRESS... ‚ú®';
            flipBtn.disabled = true;

            coinContent.innerHTML = `
                <div class="text-9xl animate-pulse mb-4 patriotic-glow">üåü</div>
                <div class="text-lg text-blue-300 tracking-wider font-light animate-pulse magical-text">FATE DECIDING...</div>
            `;

            // Create particle effects during spin
            setTimeout(() => {
                const coinRect = coin.getBoundingClientRect();
                const centerX = coinRect.left + coinRect.width / 2;
                const centerY = coinRect.top + coinRect.height / 2;
                createParticleBurst(centerX, centerY);
            }, 1000);

            setTimeout(() => {
                playMagicalChime();

                const result = getMarkovPrediction();
                markovState = result;
                history = [result, ...history.slice(0, 9)];
                tosses++;

                coin.classList.remove('animate-spin');
                coin.style.transform = 'scale(1)';

                // Heads or Tails result
                const isHeads = result === 'H';
                coinContent.innerHTML = `
                    <div class="text-9xl mb-3 patriotic-glow">${isHeads ? '‚≠ê' : 'üî¥'}</div>
                    <div class="text-2xl ${isHeads ? 'text-blue-400' : 'text-red-400'} tracking-wider font-bold magical-text">${isHeads ? 'HEADS!' : 'TAILS!'}</div>
                `;

                updateStats();
                updateHistory();
                updateQuote();
                checkLimit();

                flipBtn.textContent = 'üéÑ DISCOVER FATE üéÑ';
                flipBtn.disabled = false;
                isFlipping = false;
            }, 2500);
        }

        // Update stats
        function updateStats() {
            document.getElementById('total-count').textContent = tosses;
            document.getElementById('heads-count').textContent = history.filter(h => h === 'H').length;
            document.getElementById('tails-count').textContent = history.filter(h => h === 'T').length;
        }

        // Update history
        function updateHistory() {
            if (history.length > 0) {
                document.getElementById('history-section').style.display = 'block';
                const historyDisplay = document.getElementById('history-display');
                historyDisplay.innerHTML = '';

                history.forEach(flip => {
                    const element = document.createElement('div');
                    const isHeads = flip === 'H';
                    element.className = `w-12 h-12 rounded-full border-2 flex items-center justify-center text-2xl transition-all hover:scale-110 ${
                        isHeads
                            ? 'bg-blue-600 border-blue-500 patriotic-glow'
                            : 'bg-red-600 border-red-500 patriotic-glow'
                    }`;
                    element.textContent = isHeads ? '‚≠ê' : 'üî¥';
                    historyDisplay.appendChild(element);
                });
            }
        }

        // Check limit
        function checkLimit() {
            if (!isPremium && tosses >= 8) {
                const remaining = 10 - tosses;
                document.getElementById('remaining-flips').textContent = remaining;
                document.getElementById('limit-warning').style.display = 'block';
            }
        }

        // Buy premium
        function buyPremium() {
            isPremium = true;
            document.getElementById('subscription-modal').style.display = 'none';
            document.getElementById('premium-badge').style.display = 'inline-flex';
            document.getElementById('limit-warning').style.display = 'none';
        }

        // Close modal
        function closeModal() {
            document.getElementById('subscription-modal').style.display = 'none';
        }

        // Reset app
        function resetApp() {
            playJingleSound();
            tosses = 0;
            history = [];
            markovState = 'H';

            document.getElementById('coin-content').innerHTML = `
                <div class="text-8xl mb-4 patriotic-glow">‚ú®</div>
                <div class="text-lg text-blue-300 tracking-wider font-light magical-text">READY FOR MAGIC</div>
            `;

            updateStats();
            document.getElementById('history-section').style.display = 'none';
            document.getElementById('limit-warning').style.display = 'none';
            updateQuote();
        }

        // Add CSS animation for falling
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                to {
                    transform: translateY(100vh);
                }
            }
        `;
        document.head.appendChild(style);

        // Initialize floating particles
        createFloatingParticles();
    </script>
</body>
</html>